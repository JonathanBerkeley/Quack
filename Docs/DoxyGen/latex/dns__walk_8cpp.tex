\hypertarget{dns__walk_8cpp}{}\doxysection{\+\_\+\+\_\+quack/\+Quack-\/internal/dns\+\_\+walk.cpp File Reference}
\label{dns__walk_8cpp}\index{\_\_quack/Quack-\/internal/dns\_walk.cpp@{\_\_quack/Quack-\/internal/dns\_walk.cpp}}
{\ttfamily \#include \char`\"{}pch.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dns\+\_\+walk.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Win\+DNS.\+h\char`\"{}}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_dns_data}{Dns\+Data}}
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{struct_dns_data}{Dns\+Data}} $\ast$ \mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{Dns\+Table\+Ptr}}
\item 
using \mbox{\hyperlink{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}{Dns\+Table\+Cache\+Ptr}} = int(WINAPI $\ast$)(\mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{Dns\+Table\+Ptr}} $\ast$dns\+\_\+table\+\_\+ptr)
\item 
using \mbox{\hyperlink{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}{Dns\+Api\+Free\+Ptr}} = void(WINAPI $\ast$)(PVOID p\+\_\+data)
\item 
using \mbox{\hyperlink{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}{Dns\+Free\+Ptr}} = void(WINAPI $\ast$)(PVOID p\+\_\+data, DNS\+\_\+\+FREE\+\_\+\+TYPE free\+\_\+type)
\item 
using \mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} = std\+::optional$<$ std\+::vector$<$ \mbox{\hyperlink{struct_dns_entry}{Dns\+Entry}} $>$ $>$
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} \mbox{\hyperlink{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}{Get\+Cached\+DNSData}} (const bool cached\+\_\+load)
\begin{DoxyCompactList}\small\item\em Walk the DNS cache using undocumented DNSAPI function Will cause DNSAPI.\+dll to be loaded temporarily. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::wstring $>$ \mbox{\hyperlink{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}{Get\+Blacklisted\+Entries}} ()
\item 
\mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} \mbox{\hyperlink{dns__walk_8cpp_adf70ac31f189901cd13fa89f5300c414}{Check\+For\+Blacklisted\+DNSEntries}} ()
\begin{DoxyCompactList}\small\item\em Searches entries in the DNS cache for blacklisted domains. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dns__walk_8cpp_aad94980acc9a425f0a1a3028d49b2bd3}{Print\+DNSEntries}} (std\+::wostream \&wos)
\begin{DoxyCompactList}\small\item\em Prints DNS entries in a human readable format to supplied wide output stream. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}\label{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!DnsApiFreePtr@{DnsApiFreePtr}}
\index{DnsApiFreePtr@{DnsApiFreePtr}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{DnsApiFreePtr}{DnsApiFreePtr}}
{\footnotesize\ttfamily using \mbox{\hyperlink{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}{Dns\+Api\+Free\+Ptr}} =  void (WINAPI$\ast$)(PVOID p\+\_\+data)}



Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00018}{18}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}\label{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!DnsEntries@{DnsEntries}}
\index{DnsEntries@{DnsEntries}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{DnsEntries}{DnsEntries}}
{\footnotesize\ttfamily using \mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} =  std\+::optional$<$std\+::vector$<$\mbox{\hyperlink{struct_dns_entry}{Dns\+Entry}}$>$ $>$}



Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00021}{21}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}\label{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!DnsFreePtr@{DnsFreePtr}}
\index{DnsFreePtr@{DnsFreePtr}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{DnsFreePtr}{DnsFreePtr}}
{\footnotesize\ttfamily using \mbox{\hyperlink{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}{Dns\+Free\+Ptr}} =  void (WINAPI$\ast$)(PVOID p\+\_\+data, DNS\+\_\+\+FREE\+\_\+\+TYPE free\+\_\+type)}



Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00019}{19}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}\label{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!DnsTableCachePtr@{DnsTableCachePtr}}
\index{DnsTableCachePtr@{DnsTableCachePtr}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{DnsTableCachePtr}{DnsTableCachePtr}}
{\footnotesize\ttfamily using \mbox{\hyperlink{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}{Dns\+Table\+Cache\+Ptr}} =  int (WINAPI$\ast$)(\mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{Dns\+Table\+Ptr}}$\ast$ dns\+\_\+table\+\_\+ptr)}



Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00017}{17}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}\label{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!DnsTablePtr@{DnsTablePtr}}
\index{DnsTablePtr@{DnsTablePtr}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{DnsTablePtr}{DnsTablePtr}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{struct_dns_data}{Dns\+Data}} $\ast$ \mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{Dns\+Table\+Ptr}}}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{dns__walk_8cpp_adf70ac31f189901cd13fa89f5300c414}\label{dns__walk_8cpp_adf70ac31f189901cd13fa89f5300c414}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!CheckForBlacklistedDNSEntries@{CheckForBlacklistedDNSEntries}}
\index{CheckForBlacklistedDNSEntries@{CheckForBlacklistedDNSEntries}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{CheckForBlacklistedDNSEntries()}{CheckForBlacklistedDNSEntries()}}
{\footnotesize\ttfamily \mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} Check\+For\+Blacklisted\+DNSEntries (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Searches entries in the DNS cache for blacklisted domains. 

\begin{DoxyReturn}{Returns}
List of entries that matched the blacklist, or empty 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00116}{116}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}\label{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!GetBlacklistedEntries@{GetBlacklistedEntries}}
\index{GetBlacklistedEntries@{GetBlacklistedEntries}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{GetBlacklistedEntries()}{GetBlacklistedEntries()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::wstring $>$ Get\+Blacklisted\+Entries (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00098}{98}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}\label{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!GetCachedDNSData@{GetCachedDNSData}}
\index{GetCachedDNSData@{GetCachedDNSData}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{GetCachedDNSData()}{GetCachedDNSData()}}
{\footnotesize\ttfamily \mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{Dns\+Entries}} Get\+Cached\+DNSData (\begin{DoxyParamCaption}\item[{const bool}]{cached\+\_\+load }\end{DoxyParamCaption})}



Walk the DNS cache using undocumented DNSAPI function Will cause DNSAPI.\+dll to be loaded temporarily. 

Logic based on \href{https://github.com/malcomvetter/DnsCache}{\texttt{ https\+://github.\+com/malcomvetter/\+Dns\+Cache}} Improved with advice from \href{https://stackoverflow.com/a/31892801}{\texttt{ https\+://stackoverflow.\+com/a/31892801}} 
\begin{DoxyParams}{Parameters}
{\em cached\+\_\+load} & Whether or not to cache the DLL load attempt. Better for multiple runs, so that DNSAPI.\+dll is not continually reloaded. However, using cached\+\_\+load will mean that DNSAPI.\+dll will remain loaded even after this function is finished. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Vector containing cached Dns\+Entries on success 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00039}{39}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

\mbox{\Hypertarget{dns__walk_8cpp_aad94980acc9a425f0a1a3028d49b2bd3}\label{dns__walk_8cpp_aad94980acc9a425f0a1a3028d49b2bd3}} 
\index{dns\_walk.cpp@{dns\_walk.cpp}!PrintDNSEntries@{PrintDNSEntries}}
\index{PrintDNSEntries@{PrintDNSEntries}!dns\_walk.cpp@{dns\_walk.cpp}}
\doxysubsubsection{\texorpdfstring{PrintDNSEntries()}{PrintDNSEntries()}}
{\footnotesize\ttfamily void Print\+DNSEntries (\begin{DoxyParamCaption}\item[{std\+::wostream \&}]{wos }\end{DoxyParamCaption})}



Prints DNS entries in a human readable format to supplied wide output stream. 


\begin{DoxyParams}{Parameters}
{\em wos} & References to wide output stream \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{dns__walk_8cpp_source_l00140}{140}} of file \mbox{\hyperlink{dns__walk_8cpp_source}{dns\+\_\+walk.\+cpp}}.

