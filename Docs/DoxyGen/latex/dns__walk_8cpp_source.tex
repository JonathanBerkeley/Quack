\hypertarget{dns__walk_8cpp_source}{}\doxysection{dns\+\_\+walk.\+cpp}
\label{dns__walk_8cpp_source}\index{\_\_quack/Quack-\/internal/dns\_walk.cpp@{\_\_quack/Quack-\/internal/dns\_walk.cpp}}
\mbox{\hyperlink{dns__walk_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_red_01team_2_inertia-cheat_2_inertia-cheat_2pch_8hpp}{pch.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00002}00002 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{dns__walk_8hpp}{dns\_walk.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{utils_8hpp}{utils.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include "{}WinDNS.h"{}}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00008}\mbox{\hyperlink{struct_dns_data}{00008}} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_dns_data}{DnsData}} \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00009}\mbox{\hyperlink{struct_dns_data_a16b3cb950292df55930fbe4257132a7e}{00009}}     \mbox{\hyperlink{struct_dns_data}{DnsData}}* \mbox{\hyperlink{struct_dns_data_a16b3cb950292df55930fbe4257132a7e}{next}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00010}\mbox{\hyperlink{struct_dns_data_a76735a1ccc8256c11a1cf6c7f21927c4}{00010}}     PWSTR \mbox{\hyperlink{struct_dns_data_a76735a1ccc8256c11a1cf6c7f21927c4}{name}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00011}\mbox{\hyperlink{struct_dns_data_a746ed339125b3e43c9c8ada836f7e7c9}{00011}}     WORD \mbox{\hyperlink{struct_dns_data_a746ed339125b3e43c9c8ada836f7e7c9}{type}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00012}\mbox{\hyperlink{struct_dns_data_a7542574de3427a0b8df25046504865ac}{00012}}     WORD \mbox{\hyperlink{struct_dns_data_a7542574de3427a0b8df25046504865ac}{data\_length}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00013}\mbox{\hyperlink{struct_dns_data_a1e68b0332a31d7202ad00f597cee76e8}{00013}}     DWORD \mbox{\hyperlink{struct_dns_data_a1e68b0332a31d7202ad00f597cee76e8}{flags}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00014}\mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{00014}} \} *\mbox{\hyperlink{dns__walk_8cpp_a72d0bec0a94bbd5c4f51d79a45720666}{DnsTablePtr}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00017}\mbox{\hyperlink{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}{00017}} \textcolor{keyword}{using }\mbox{\hyperlink{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}{DnsTableCachePtr}} = int (WINAPI*)(\mbox{\hyperlink{struct_dns_data}{DnsTablePtr}}* dns\_table\_ptr);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00018}\mbox{\hyperlink{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}{00018}} \textcolor{keyword}{using }\mbox{\hyperlink{dns__walk_8cpp_a853d66c4fe175b1a67c97cb955e0f562}{DnsApiFreePtr}} = void (WINAPI*)(PVOID p\_data);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00019}\mbox{\hyperlink{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}{00019}} \textcolor{keyword}{using }\mbox{\hyperlink{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}{DnsFreePtr}} = void (WINAPI*)(PVOID p\_data, DNS\_FREE\_TYPE free\_type);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00021}\mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{00021}} \textcolor{keyword}{using }\mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{DnsEntries}} = std::optional<std::vector<DnsEntry>>;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00022}00022 \textcolor{keyword}{namespace }ranges = std::ranges;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00025}00025 \textcolor{comment}{// ReSharper disable CppLocalVariableMayBeConst (Buggy with WinAPI typedefs)}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00026}00026 \textcolor{comment}{// ReSharper disable CppClangTidyClangDiagnosticCastFunctionType (Incorrect with FARPROC)}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00039}\mbox{\hyperlink{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}{00039}} \textcolor{comment}{}\mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{DnsEntries}} \mbox{\hyperlink{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}{GetCachedDNSData}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} cached\_load) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00040}00040     std::vector<DnsEntry> entries\{\};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00042}00042     \mbox{\hyperlink{struct_dns_data}{DnsTablePtr}} table\_entry = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00044}00044     HMODULE dns\_lib = cached\_load}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00045}00045         ? \mbox{\hyperlink{utils_8cpp_a84817d79c47f5b13735e17b57a386f92}{CachedLoadLibrary}}(L\textcolor{stringliteral}{"{}DNSAPI.dll"{}})}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00046}00046         : LoadLibrary(L\textcolor{stringliteral}{"{}DNSAPI.dll"{}});}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00048}00048     \textcolor{keywordflow}{if} (dns\_lib == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00049}00049         \textcolor{keywordflow}{return} std::nullopt;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00050}00050     }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00051}00051     \textcolor{comment}{// Obtain pointer to undocumented DnsGetCacheDataTable function in DNSAPI}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00052}00052     FARPROC DnsGetCacheDataTableFunc = GetProcAddress(dns\_lib, \textcolor{stringliteral}{"{}DnsGetCacheDataTable"{}});}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00053}00053     \textcolor{keyword}{const} \textcolor{keyword}{auto} DnsGetCacheDataTable = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{dns__walk_8cpp_aa33dd7050edc0dac6e8b192e43a1ba01}{DnsTableCachePtr}}\textcolor{keyword}{>}(DnsGetCacheDataTableFunc);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00055}00055     \textcolor{comment}{// Obtain pointer to DnsFree function in DNSAPI}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00056}00056     FARPROC DnsFreeFunc = GetProcAddress(dns\_lib, \textcolor{stringliteral}{"{}DnsFree"{}});}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00057}00057     \textcolor{keyword}{const} \textcolor{keyword}{auto} DnsFree = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{dns__walk_8cpp_aae209c7f0fd849600c4aaf9a7fbe7d81}{DnsFreePtr}}\textcolor{keyword}{>}(DnsFreeFunc);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00059}00059     \textcolor{comment}{// Gets pointer to beginning of table}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00060}00060     DnsGetCacheDataTable(\&table\_entry);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00062}00062     \textcolor{keywordflow}{if} (table\_entry == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00063}00063         DnsFree(table\_entry, DnsFreeFlat);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00064}00064         \textcolor{keywordflow}{return} std::nullopt;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00065}00065     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00067}00067     \textcolor{comment}{// Enumerate the cache}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00068}00068     \textcolor{keywordflow}{while} (table\_entry) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00069}00069         \textcolor{comment}{// Store copy of entry that is found}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00070}00070         \mbox{\hyperlink{struct_dns_entry}{DnsEntry}} this\_entry;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00071}00071         this\_entry.\mbox{\hyperlink{struct_dns_entry_ad01aa9cd5117cc6da7049d619870a7da}{name}} = std::wstring\{ table\_entry-\/>\mbox{\hyperlink{struct_dns_data_a76735a1ccc8256c11a1cf6c7f21927c4}{name}} \};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00072}00072         this\_entry.\mbox{\hyperlink{struct_dns_entry_a0d65a29fbaf1c3d08f3aaad5935a95a0}{type}} = table\_entry-\/>\mbox{\hyperlink{struct_dns_data_a746ed339125b3e43c9c8ada836f7e7c9}{type}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00073}00073         entries.emplace\_back(this\_entry);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00075}00075         \textcolor{comment}{// Cleanup}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00076}00076         DnsFree(table\_entry-\/>\mbox{\hyperlink{struct_dns_data_a76735a1ccc8256c11a1cf6c7f21927c4}{name}}, DnsFreeFlat);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00077}00077         PVOID previous\_p\_entry = table\_entry;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00079}00079         \textcolor{comment}{// Go to next entry}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00080}00080         table\_entry = table\_entry-\/>\mbox{\hyperlink{struct_dns_data_a16b3cb950292df55930fbe4257132a7e}{next}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00082}00082         DnsFree(previous\_p\_entry, DnsFreeFlat);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00083}00083     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00085}00085     \textcolor{comment}{// todo: Verify no leaks possible}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00087}00087     \textcolor{comment}{// Cleanup}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00088}00088     \textcolor{keywordflow}{if} (!cached\_load) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00089}00089         FreeLibrary(dns\_lib);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00090}00090     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00092}00092     \textcolor{keywordflow}{return} \mbox{\hyperlink{utils_8hpp_a9dbea9df0654c3d551d35ae4bd7d4c8f}{IfNotEmpty}}(entries);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00093}00093 \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00094}00094 \textcolor{comment}{// ReSharper restore CppLocalVariableMayBeConst}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00095}00095 \textcolor{comment}{// ReSharper restore CppClangTidyClangDiagnosticCastFunctionType}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00098}\mbox{\hyperlink{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}{00098}} std::vector<std::wstring> \mbox{\hyperlink{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}{GetBlacklistedEntries}}() \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00099}00099     \textcolor{comment}{// todo: Network blacklisted entries}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00101}00101     std::vector<std::wstring> blacklist\{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00102}00102         \textcolor{comment}{// Examples only}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00103}00103         L\textcolor{stringliteral}{"{}client.aimware.net"{}},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00104}00104         L\textcolor{stringliteral}{"{}aimware.net"{}},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00105}00105         L\textcolor{stringliteral}{"{}cdn.aimware.net"{}}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00106}00106     \};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00108}00108     \textcolor{keywordflow}{return} blacklist;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00109}00109 \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00110}00110 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00116}\mbox{\hyperlink{dns__walk_8cpp_adf70ac31f189901cd13fa89f5300c414}{00116}} \mbox{\hyperlink{dns__walk_8cpp_a4b4d2ef4447201eb3b6f68f323d25671}{DnsEntries}} \mbox{\hyperlink{dns__walk_8cpp_adf70ac31f189901cd13fa89f5300c414}{CheckForBlacklistedDNSEntries}}() \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00117}00117     std::vector<DnsEntry> matches\{\};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00119}00119     \textcolor{keyword}{auto} blacklist = \mbox{\hyperlink{dns__walk_8cpp_a30912597ea271b2b946c03d3480c0a43}{GetBlacklistedEntries}}();}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00121}00121     \textcolor{keyword}{const} \textcolor{keyword}{auto} dns\_cache = \mbox{\hyperlink{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}{GetCachedDNSData}}(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00122}00122     \textcolor{keywordflow}{if} (!dns\_cache)}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00123}00123         \textcolor{keywordflow}{return} std::nullopt;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00125}00125     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& entry : dns\_cache.value()) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00126}00126         \textcolor{keywordflow}{if} (ranges::find(blacklist, entry.name) != blacklist.end()) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00127}00127             matches.emplace\_back(entry);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00128}00128         \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00129}00129     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00131}00131     \textcolor{comment}{// Return the entries, or empty if there were none}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00132}00132     \textcolor{keywordflow}{return} \mbox{\hyperlink{utils_8hpp_a9dbea9df0654c3d551d35ae4bd7d4c8f}{IfNotEmpty}}(matches);}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00133}00133 \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00140}\mbox{\hyperlink{dns__walk_8cpp_aad94980acc9a425f0a1a3028d49b2bd3}{00140}} \textcolor{keywordtype}{void} \mbox{\hyperlink{dns__walk_8cpp_aad94980acc9a425f0a1a3028d49b2bd3}{PrintDNSEntries}}(std::wostream\& wos) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00141}00141     \textcolor{keyword}{const} \textcolor{keyword}{auto} dns\_cache = \mbox{\hyperlink{dns__walk_8cpp_ad614910cd368ea2dda293f33809227b3}{GetCachedDNSData}}(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00143}00143     \textcolor{keywordflow}{if} (!dns\_cache) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00144}00144         wos << L\textcolor{stringliteral}{"{}DNS search failed.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00145}00145         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00146}00146     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00148}00148     \textcolor{comment}{// Map dns flag values to printable names}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00149}00149     \textcolor{comment}{// https://docs.microsoft.com/en-\/us/windows/win32/dns/dns-\/constants}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00150}00150     \textcolor{keyword}{const} std::unordered\_map<int, std::wstring> dns\_mappings\{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00151}00151         \{DNS\_TYPE\_A, L\textcolor{stringliteral}{"{}A"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00152}00152         \{DNS\_TYPE\_NS, L\textcolor{stringliteral}{"{}NS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00153}00153         \{DNS\_TYPE\_MD, L\textcolor{stringliteral}{"{}MD"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00154}00154         \{DNS\_TYPE\_MF, L\textcolor{stringliteral}{"{}MF"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00155}00155         \{DNS\_TYPE\_CNAME, L\textcolor{stringliteral}{"{}CNAME"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00156}00156         \{DNS\_TYPE\_SOA, L\textcolor{stringliteral}{"{}SOA"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00157}00157         \{DNS\_TYPE\_MB, L\textcolor{stringliteral}{"{}MB"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00158}00158         \{DNS\_TYPE\_MG, L\textcolor{stringliteral}{"{}MG"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00159}00159         \{DNS\_TYPE\_MR, L\textcolor{stringliteral}{"{}MR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00160}00160         \{DNS\_TYPE\_NULL, L\textcolor{stringliteral}{"{}NULL"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00161}00161         \{DNS\_TYPE\_WKS, L\textcolor{stringliteral}{"{}WKS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00162}00162         \{DNS\_TYPE\_PTR, L\textcolor{stringliteral}{"{}PTR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00163}00163         \{DNS\_TYPE\_HINFO, L\textcolor{stringliteral}{"{}HINFO"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00164}00164         \{DNS\_TYPE\_MINFO, L\textcolor{stringliteral}{"{}MINFO"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00165}00165         \{DNS\_TYPE\_MX, L\textcolor{stringliteral}{"{}MX"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00166}00166         \{DNS\_TYPE\_TEXT, L\textcolor{stringliteral}{"{}TEXT"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00167}00167         \{DNS\_TYPE\_RP, L\textcolor{stringliteral}{"{}RP"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00168}00168         \{DNS\_TYPE\_AFSDB, L\textcolor{stringliteral}{"{}AFSDB"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00169}00169         \{DNS\_TYPE\_X25, L\textcolor{stringliteral}{"{}X25"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00170}00170         \{DNS\_TYPE\_ISDN, L\textcolor{stringliteral}{"{}ISDN"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00171}00171         \{DNS\_TYPE\_RT, L\textcolor{stringliteral}{"{}RT"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00172}00172         \{DNS\_TYPE\_NSAP, L\textcolor{stringliteral}{"{}NSAP"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00173}00173         \{DNS\_TYPE\_NSAPPTR, L\textcolor{stringliteral}{"{}NSAPPTR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00174}00174         \{DNS\_TYPE\_SIG, L\textcolor{stringliteral}{"{}SIG"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00175}00175         \{DNS\_TYPE\_KEY, L\textcolor{stringliteral}{"{}KEY"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00176}00176         \{DNS\_TYPE\_PX, L\textcolor{stringliteral}{"{}PX"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00177}00177         \{DNS\_TYPE\_GPOS, L\textcolor{stringliteral}{"{}GPOS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00178}00178         \{DNS\_TYPE\_AAAA, L\textcolor{stringliteral}{"{}AAAA"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00179}00179         \{DNS\_TYPE\_LOC, L\textcolor{stringliteral}{"{}LOC"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00180}00180         \{DNS\_TYPE\_NXT, L\textcolor{stringliteral}{"{}NXT"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00181}00181         \{DNS\_TYPE\_EID, L\textcolor{stringliteral}{"{}EID"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00182}00182         \{DNS\_TYPE\_NIMLOC, L\textcolor{stringliteral}{"{}NIMLOC"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00183}00183         \{DNS\_TYPE\_SRV, L\textcolor{stringliteral}{"{}SRV"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00184}00184         \{DNS\_TYPE\_ATMA, L\textcolor{stringliteral}{"{}ATMA"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00185}00185         \{DNS\_TYPE\_NAPTR, L\textcolor{stringliteral}{"{}NAPTR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00186}00186         \{DNS\_TYPE\_KX, L\textcolor{stringliteral}{"{}KX"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00187}00187         \{DNS\_TYPE\_CERT, L\textcolor{stringliteral}{"{}CERT"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00188}00188         \{DNS\_TYPE\_A6, L\textcolor{stringliteral}{"{}A6"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00189}00189         \{DNS\_TYPE\_DNAME, L\textcolor{stringliteral}{"{}DNAME"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00190}00190         \{DNS\_TYPE\_SINK, L\textcolor{stringliteral}{"{}SINK"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00191}00191         \{DNS\_TYPE\_OPT, L\textcolor{stringliteral}{"{}OPT"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00192}00192         \{DNS\_TYPE\_DS, L\textcolor{stringliteral}{"{}DS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00193}00193         \{DNS\_TYPE\_RRSIG, L\textcolor{stringliteral}{"{}RRSIG"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00194}00194         \{DNS\_TYPE\_NSEC, L\textcolor{stringliteral}{"{}NSEC"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00195}00195         \{DNS\_TYPE\_DNSKEY, L\textcolor{stringliteral}{"{}DNSKEY"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00196}00196         \{DNS\_TYPE\_DHCID, L\textcolor{stringliteral}{"{}DHCID"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00197}00197         \{DNS\_TYPE\_UINFO, L\textcolor{stringliteral}{"{}UINFO"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00198}00198         \{DNS\_TYPE\_UID, L\textcolor{stringliteral}{"{}UID"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00199}00199         \{DNS\_TYPE\_GID, L\textcolor{stringliteral}{"{}GID"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00200}00200         \{DNS\_TYPE\_UNSPEC, L\textcolor{stringliteral}{"{}UNSPEC"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00201}00201         \{DNS\_TYPE\_ADDRS, L\textcolor{stringliteral}{"{}ADDRS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00202}00202         \{DNS\_TYPE\_TKEY, L\textcolor{stringliteral}{"{}TKEY"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00203}00203         \{DNS\_TYPE\_TSIG, L\textcolor{stringliteral}{"{}TSIG"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00204}00204         \{DNS\_TYPE\_IXFR, L\textcolor{stringliteral}{"{}IXFR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00205}00205         \{DNS\_TYPE\_AXFR, L\textcolor{stringliteral}{"{}AXFR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00206}00206         \{DNS\_TYPE\_MAILB, L\textcolor{stringliteral}{"{}MAILB"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00207}00207         \{DNS\_TYPE\_MAILA, L\textcolor{stringliteral}{"{}MAILA"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00208}00208         \{DNS\_TYPE\_ALL, L\textcolor{stringliteral}{"{}ALL"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00209}00209         \{DNS\_TYPE\_ANY, L\textcolor{stringliteral}{"{}ANY"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00210}00210         \{DNS\_TYPE\_WINS, L\textcolor{stringliteral}{"{}WINS"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00211}00211         \{DNS\_TYPE\_WINSR, L\textcolor{stringliteral}{"{}WINSR"{}}\},}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00212}00212         \{DNS\_TYPE\_NBSTAT, L\textcolor{stringliteral}{"{}NBSTAT"{}}\}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00213}00213     \};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00215}00215     \textcolor{keywordtype}{int} count = 0;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00216}00216     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [name, type] : dns\_cache.value()) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00217}00217         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00218}00218             ++count;}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00219}00219             wos << dns\_mappings.at(type) << L\textcolor{stringliteral}{"{} : "{}} << name << L\textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00220}00220         \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00221}00221         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::out\_of\_range\&) \{}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00222}00222             wos << L\textcolor{stringliteral}{"{}Unknown : "{}} << name << L\textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00223}00223         \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00224}00224     \}}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00226}00226     wos << L\textcolor{stringliteral}{"{}DNS Records found: "{}}  << count << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{dns__walk_8cpp_source_l00227}00227 \}}

\end{DoxyCode}
