\hypertarget{memory__scanner_8cpp}{}\doxysection{\+\_\+\+\_\+quack/\+Quack-\/internal/memory\+\_\+scanner.cpp File Reference}
\label{memory__scanner_8cpp}\index{\_\_quack/Quack-\/internal/memory\_scanner.cpp@{\_\_quack/Quack-\/internal/memory\_scanner.cpp}}
{\ttfamily \#include \char`\"{}pch.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ban.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}memory\+\_\+scanner.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$Soft\+Pub.\+h$>$}\newline
{\ttfamily \#include $<$Win\+Trust.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ HMODULE $>$ \mbox{\hyperlink{memory__scanner_8cpp_acea7c94e476706b397d76faee2317412}{Enumerate\+Modules}} (const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&process\+\_\+info)
\begin{DoxyCompactList}\small\item\em Enumerates through loaded modules, returns vector of results. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{memory__scanner_8cpp_a990a578ffbeeb49aba389620d153b683}{Verify\+Module}} (const LPCWSTR source\+\_\+file)
\begin{DoxyCompactList}\small\item\em Verifies signature for source file, based on MSDN example code. \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned long $>$ \mbox{\hyperlink{memory__scanner_8cpp_a28181accbbef183e3bd1c232250ba19f}{Pattern\+To\+Byte}} (const std\+::string \&signature)
\begin{DoxyCompactList}\small\item\em Converts supplied signature to bytes, removing wildcards. \end{DoxyCompactList}\item 
std\+::uint8\+\_\+t $\ast$ \mbox{\hyperlink{memory__scanner_8cpp_a21c6c3348901651c3ff03e7cdc610e8c}{Pattern\+Scan}} (const HMODULE module, const std\+::string \&signature)
\begin{DoxyCompactList}\small\item\em Scans module for supplied signature. \end{DoxyCompactList}\item 
std\+::uint8\+\_\+t $\ast$ \mbox{\hyperlink{memory__scanner_8cpp_a6f5661ae7206f7751587a687d4b421fb}{Pattern\+Scan}} (const std\+::string \&signature, const \mbox{\hyperlink{struct_memory_region}{Memory\+Region}} \&mem\+\_\+region)
\begin{DoxyCompactList}\small\item\em Scans a region for a provided signature. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classdata_1_1_signatures}{Signatures}} \mbox{\hyperlink{memory__scanner_8cpp_a9655c919d6586782d25a74508a661754}{Get\+Signatures}} (const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&context)
\begin{DoxyCompactList}\small\item\em Fetches known cheat signatures. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{memory__scanner_8cpp_a4f466c30ccd782474f4dea34cc470cc1}{Module\+Scan}} (const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&context, const bool unsigned\+\_\+only)
\begin{DoxyCompactList}\small\item\em Scans a module that is loaded into the process. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{memory__scanner_8cpp_a2ae050caa2cab158f3f0de9796e62343}{Region\+Scan}} (const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&context, const \mbox{\hyperlink{struct_memory_region}{Memory\+Region}} \&memory\+\_\+region)
\begin{DoxyCompactList}\small\item\em Scans a region of memory provided by param memory\+\_\+region. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{memory__scanner_8cpp_ad9f74c4315ef2c88f6ad70fa1f151096}{Full\+Scan}} (const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&context)
\begin{DoxyCompactList}\small\item\em Scan all of executable memory. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{memory__scanner_8cpp_acea7c94e476706b397d76faee2317412}\label{memory__scanner_8cpp_acea7c94e476706b397d76faee2317412}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!EnumerateModules@{EnumerateModules}}
\index{EnumerateModules@{EnumerateModules}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{EnumerateModules()}{EnumerateModules()}}
{\footnotesize\ttfamily std\+::vector$<$ HMODULE $>$ Enumerate\+Modules (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&}]{process\+\_\+info }\end{DoxyParamCaption})}



Enumerates through loaded modules, returns vector of results. 


\begin{DoxyParams}{Parameters}
{\em process\+\_\+info} & Information about the current process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Vector of HMODULEs that correspond to the starting address of loaded modules 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00025}{25}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_ad9f74c4315ef2c88f6ad70fa1f151096}\label{memory__scanner_8cpp_ad9f74c4315ef2c88f6ad70fa1f151096}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!FullScan@{FullScan}}
\index{FullScan@{FullScan}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{FullScan()}{FullScan()}}
{\footnotesize\ttfamily void Full\+Scan (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&}]{context }\end{DoxyParamCaption})}



Scan all of executable memory. 


\begin{DoxyParams}{Parameters}
{\em context} & Information about the current process \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00300}{300}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a9655c919d6586782d25a74508a661754}\label{memory__scanner_8cpp_a9655c919d6586782d25a74508a661754}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!GetSignatures@{GetSignatures}}
\index{GetSignatures@{GetSignatures}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{GetSignatures()}{GetSignatures()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdata_1_1_signatures}{Signatures}} Get\+Signatures (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&}]{context }\end{DoxyParamCaption})}



Fetches known cheat signatures. 


\begin{DoxyParams}{Parameters}
{\em context} & Information about the current process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Signature data 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00185}{185}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a4f466c30ccd782474f4dea34cc470cc1}\label{memory__scanner_8cpp_a4f466c30ccd782474f4dea34cc470cc1}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!ModuleScan@{ModuleScan}}
\index{ModuleScan@{ModuleScan}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{ModuleScan()}{ModuleScan()}}
{\footnotesize\ttfamily void Module\+Scan (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&}]{context,  }\item[{const bool}]{unsigned\+\_\+only }\end{DoxyParamCaption})}



Scans a module that is loaded into the process. 


\begin{DoxyParams}{Parameters}
{\em context} & Information about the current process \\
\hline
{\em unsigned\+\_\+only} & Whether to scan unsigned modules only, or to scan all modules \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00204}{204}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a21c6c3348901651c3ff03e7cdc610e8c}\label{memory__scanner_8cpp_a21c6c3348901651c3ff03e7cdc610e8c}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!PatternScan@{PatternScan}}
\index{PatternScan@{PatternScan}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{PatternScan()}{PatternScan()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily std\+::uint8\+\_\+t $\ast$ Pattern\+Scan (\begin{DoxyParamCaption}\item[{const HMODULE}]{module,  }\item[{const std\+::string \&}]{signature }\end{DoxyParamCaption})}



Scans module for supplied signature. 

Logic learned from example in CSGOSimple \href{https://github.com/spirthack/CSGOSimple}{\texttt{ https\+://github.\+com/spirthack/\+CSGOSimple}} 
\begin{DoxyParams}{Parameters}
{\em module} & Handle to module \\
\hline
{\em signature} & The signature to be scanned for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If signature detected, a pointer to detected signature otherwise nullptr 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00126}{126}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a6f5661ae7206f7751587a687d4b421fb}\label{memory__scanner_8cpp_a6f5661ae7206f7751587a687d4b421fb}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!PatternScan@{PatternScan}}
\index{PatternScan@{PatternScan}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{PatternScan()}{PatternScan()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily std\+::uint8\+\_\+t $\ast$ Pattern\+Scan (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{signature,  }\item[{const \mbox{\hyperlink{struct_memory_region}{Memory\+Region}} \&}]{mem\+\_\+region }\end{DoxyParamCaption})}



Scans a region for a provided signature. 


\begin{DoxyParams}{Parameters}
{\em signature} & Signature to search for \\
\hline
{\em mem\+\_\+region} & Memory region to search \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to start address of matched pattern 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00159}{159}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a28181accbbef183e3bd1c232250ba19f}\label{memory__scanner_8cpp_a28181accbbef183e3bd1c232250ba19f}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!PatternToByte@{PatternToByte}}
\index{PatternToByte@{PatternToByte}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{PatternToByte()}{PatternToByte()}}
{\footnotesize\ttfamily std\+::vector$<$ unsigned long $>$ Pattern\+To\+Byte (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{signature }\end{DoxyParamCaption})}



Converts supplied signature to bytes, removing wildcards. 


\begin{DoxyParams}{Parameters}
{\em signature} & Signature to be converted to bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Vector of unsigned long, representing bytes 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00084}{84}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a2ae050caa2cab158f3f0de9796e62343}\label{memory__scanner_8cpp_a2ae050caa2cab158f3f0de9796e62343}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!RegionScan@{RegionScan}}
\index{RegionScan@{RegionScan}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{RegionScan()}{RegionScan()}}
{\footnotesize\ttfamily void Region\+Scan (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdata_1_1_process_info}{Process\+Info}} \&}]{context,  }\item[{const \mbox{\hyperlink{struct_memory_region}{Memory\+Region}} \&}]{memory\+\_\+region }\end{DoxyParamCaption})}



Scans a region of memory provided by param memory\+\_\+region. 


\begin{DoxyParams}{Parameters}
{\em context} & Information about the current process \\
\hline
{\em memory\+\_\+region} & Information about the memory region to scan, containing size and start address \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00270}{270}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

\mbox{\Hypertarget{memory__scanner_8cpp_a990a578ffbeeb49aba389620d153b683}\label{memory__scanner_8cpp_a990a578ffbeeb49aba389620d153b683}} 
\index{memory\_scanner.cpp@{memory\_scanner.cpp}!VerifyModule@{VerifyModule}}
\index{VerifyModule@{VerifyModule}!memory\_scanner.cpp@{memory\_scanner.cpp}}
\doxysubsubsection{\texorpdfstring{VerifyModule()}{VerifyModule()}}
{\footnotesize\ttfamily bool Verify\+Module (\begin{DoxyParamCaption}\item[{const LPCWSTR}]{source\+\_\+file }\end{DoxyParamCaption})}



Verifies signature for source file, based on MSDN example code. 

\href{https://docs.microsoft.com/en-us/windows/win32/seccrypto/example-c-program&ndash;verifying-the-signature-of-a-pe-file}{\texttt{ https\+://docs.\+microsoft.\+com/en-\/us/windows/win32/seccrypto/example-\/c-\/program--verifying-\/the-\/signature-\/of-\/a-\/pe-\/file}} 
\begin{DoxyParams}{Parameters}
{\em source\+\_\+file} & Image name to verify \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the module is verified, false otherwise 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{memory__scanner_8cpp_source_l00046}{46}} of file \mbox{\hyperlink{memory__scanner_8cpp_source}{memory\+\_\+scanner.\+cpp}}.

